{"primaryContentSections":[{"kind":"content","content":[{"anchor":"Overview","level":2,"type":"heading","text":"Overview"},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"ModDelay.svg"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The LFO’s output (typically a sinusoid or triangle wave) sets the instantaneous delay-time (i.e., the position of the output tap along the  delay-line’s length), which then varies cyclically between limits "},{"type":"emphasis","inlineContent":[{"type":"text","text":"min _delay"}]},{"type":"text","text":" and "},{"type":"emphasis","inlineContent":[{"type":"text","text":"max_delay"}]},{"type":"text","text":", about a midpoint "},{"type":"emphasis","inlineContent":[{"type":"text","text":"mid_delay"}]},{"type":"text","text":"."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The balance between the “dry” (input) signal and the “wet” (delayed) signal is usually set based on a user-selected fraction "},{"type":"emphasis","inlineContent":[{"type":"text","text":"wf"}]},{"type":"text","text":" applied as a scaling factor ("},{"type":"emphasis","inlineContent":[{"type":"text","text":"Wet Level"}]},{"type":"text","text":" in the diagram) on the wet signal, with the corresponding "},{"type":"emphasis","inlineContent":[{"type":"text","text":"Dry Level"}]},{"type":"text","text":" set as "},{"type":"emphasis","inlineContent":[{"type":"text","text":"1.0 − f"}]},{"type":"text","text":", so there is no net gain."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"A user-selected "},{"type":"emphasis","inlineContent":[{"type":"text","text":"Rate"}]},{"type":"text","text":" parameter sets the LFO frequency, and a "},{"type":"emphasis","inlineContent":[{"type":"text","text":"Depth"}]},{"type":"text","text":" parameter sets the difference between "},{"type":"emphasis","inlineContent":[{"type":"text","text":"max_delay"}]},{"type":"text","text":" and "},{"type":"emphasis","inlineContent":[{"type":"text","text":"min_delay"}]},{"type":"text","text":"."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"For some effects, a fraction (indicated as "},{"type":"emphasis","inlineContent":[{"type":"text","text":"Feedback"}]},{"type":"text","text":" in the diagram) of the delayed signal is fed back into the delay line."}]},{"anchor":"Chorus","level":3,"type":"heading","text":"Chorus"},{"type":"paragraph","inlineContent":[{"type":"text","text":"For a chorus effect, the delay time varies about "},{"type":"emphasis","inlineContent":[{"type":"text","text":"mid_delay"}]},{"type":"text","text":" which is fixed at the midpoint of the delay-line, whose total length is typically 20-40 ms. A user-selected "},{"type":"emphasis","inlineContent":[{"type":"text","text":"Depth"}]},{"type":"text","text":" parameter controls how far "},{"type":"emphasis","inlineContent":[{"type":"text","text":"mid_delay"}]},{"type":"text","text":" and "},{"type":"emphasis","inlineContent":[{"type":"text","text":"max_delay"}]},{"type":"text","text":" deviate from this central value, from a minimum of zero (no change) to the point where "},{"type":"emphasis","inlineContent":[{"type":"text","text":"min_delay"}]},{"type":"text","text":" becomes zero. No feedback is used."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"In the "},{"type":"strong","inlineContent":[{"type":"text","text":"Chorus"}]},{"type":"text","text":" effect, "},{"type":"emphasis","inlineContent":[{"type":"text","text":"mid_delay"}]},{"type":"text","text":" is fixed at 14 ms. Setting the "},{"type":"emphasis","inlineContent":[{"type":"text","text":"Depth"}]},{"type":"text","text":" parameter to 1.0 (maximum) results in actual delay values of 14 ± 10 ms, i.e. "},{"type":"emphasis","inlineContent":[{"type":"text","text":"min_delay"}]},{"type":"text","text":" = 4 ms, "},{"type":"emphasis","inlineContent":[{"type":"text","text":"max_delay"}]},{"type":"text","text":" = 24 ms. The "},{"type":"emphasis","inlineContent":[{"type":"text","text":"Feedback"}]},{"type":"text","text":" parameter will normally be left at the default value of 0, but can be set as high as 0.25. "},{"type":"strong","inlineContent":[{"type":"text","text":"Chorus"}]},{"type":"text","text":" uses a sine-wave LFO, range 0.1 Hz to 10.0 Hz."}]},{"anchor":"Flanger","level":3,"type":"heading","text":"Flanger"},{"type":"paragraph","inlineContent":[{"type":"text","text":"For a flanging effect, "},{"type":"emphasis","inlineContent":[{"type":"text","text":"min_delay"}]},{"type":"text","text":" is fixed at nearly zero, and the user-selected "},{"type":"emphasis","inlineContent":[{"type":"text","text":"Depth"}]},{"type":"text","text":" parameter controls "},{"type":"emphasis","inlineContent":[{"type":"text","text":"max_delay"}]},{"type":"text","text":", from a minimum of zero to a maximum of about 7-10 ms. Typical settings include a 50\/50 wet\/dry mix, and at least some feedback."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The "},{"type":"emphasis","inlineContent":[{"type":"text","text":"Feedback"}]},{"type":"text","text":" parameter is a signed fraction in the range -1.0 to + 1.0, where negative values indicate that the signal is inverted before begin fed back. This is important because when the delay time gets very close to zero, the low-frequency parts of the wet and dry signals overlap almost perfectly, so positive feedback can result in a sudden increase in volume. Using negative feedback instead yields a momentary reduction in volume, which is less noticeable."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"In the "},{"type":"strong","inlineContent":[{"type":"text","text":"Flanger"}]},{"type":"text","text":" effect, setting the "},{"type":"emphasis","inlineContent":[{"type":"text","text":"Depth"}]},{"type":"text","text":" parameter to 1.0 results in "},{"type":"emphasis","inlineContent":[{"type":"text","text":"max_delay"}]},{"type":"text","text":" = 10 ms. "},{"type":"emphasis","inlineContent":[{"type":"text","text":"Feedback"}]},{"type":"text","text":" may vary from -0.95 to +0.95. LFO is a triangle wave, 0.1 - 10 Hz."}]},{"anchor":"Vibrato","level":3,"type":"heading","text":"Vibrato"},{"type":"paragraph","inlineContent":[{"type":"text","text":"With a modulated-delay effect in either chorus ("},{"type":"emphasis","inlineContent":[{"type":"text","text":"mid_delay"}]},{"type":"text","text":" fixed at midpoint of delay-line) or flanger ("},{"type":"emphasis","inlineContent":[{"type":"text","text":"min_delay"}]},{"type":"text","text":" fixed at near-zero) configuration, setting the "},{"type":"emphasis","inlineContent":[{"type":"text","text":"Wet Level"}]},{"type":"text","text":" to 100% will yield a vibrato effect. This is due to the effect of the LFO modulating the delay time. When the delay-time is decreasing, the short fragment of sound in the delay-line is effectively resampled at a rate faster than its original sample rate, so the pitch rises. When the delay-time is increasing, the sound is resampled at a rate slower than its original sampling rate, so the pitch drops."}]},{"anchor":"Stereo-Chorus-and-Flanging","level":3,"type":"heading","text":"Stereo Chorus and Flanging"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Both "},{"type":"strong","inlineContent":[{"type":"text","text":"Chorus"}]},{"type":"text","text":" and "},{"type":"strong","inlineContent":[{"type":"text","text":"Flanger"}]},{"type":"text","text":" are actually stereo effects. The DSP structure shown in the above diagram is duplicated for each of the Left and Right channels. The two LFOs run in lock-step at the same frequency (set by the "},{"type":"emphasis","inlineContent":[{"type":"text","text":"Rate"}]},{"type":"text","text":" parameter) and amplitude (set by "},{"type":"emphasis","inlineContent":[{"type":"text","text":"Depth"}]},{"type":"text","text":"), but offset in phase by 90 degrees. This technique, called "},{"type":"emphasis","inlineContent":[{"type":"text","text":"quadrature modulation"}]},{"type":"text","text":", is quite common in stereo modulation effects."}]},{"anchor":"For-more-information","level":3,"type":"heading","text":"For more information"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Modulated-delay effects are described in detail in Chapter 10 of "},{"type":"reference","isActive":true,"identifier":"https:\/\/www.amazon.com\/Designing-Audio-Effect-Plug-Ins-Processing\/dp\/0240825152"},{"type":"text","text":" by Will Pirkle."}]}]}],"schemaVersion":{"major":0,"minor":3,"patch":0},"sections":[],"variants":[{"paths":["\/documentation\/dunneaudiokit\/modulateddelayeffects"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"url":"doc:\/\/DunneAudioKit\/documentation\/DunneAudioKit\/ModulatedDelayEffects","interfaceLanguage":"swift"},"abstract":[{"type":"text","text":"Modulated-delay effects include "},{"type":"strong","inlineContent":[{"type":"text","text":"chorus"}]},{"type":"text","text":", "},{"type":"strong","inlineContent":[{"type":"text","text":"flanging"}]},{"type":"text","text":", and "},{"type":"strong","inlineContent":[{"type":"text","text":"vibrato"}]},{"type":"text","text":". These are all achieved by mixing an input signal with a delayed version of itself, and modulating the delay-time with a low-frequency oscillator (LFO)."}],"kind":"article","metadata":{"roleHeading":"Article","title":"Modulated Delay Effects","role":"article","modules":[{"name":"DunneAudioKit"}]},"hierarchy":{"paths":[["doc:\/\/DunneAudioKit\/documentation\/DunneAudioKit"]]},"references":{"doc://DunneAudioKit/documentation/DunneAudioKit":{"role":"collection","title":"DunneAudioKit","abstract":[{"type":"text","text":"Chorus, Flanger, Sampler, Stereo Delay, and Synth for AudioKit, by Shane Dunne."}],"identifier":"doc:\/\/DunneAudioKit\/documentation\/DunneAudioKit","kind":"symbol","type":"topic","url":"\/documentation\/dunneaudiokit"},"ModDelay.svg":{"alt":"ModDelay Circuit Diagram","type":"image","identifier":"ModDelay.svg","variants":[{"url":"\/images\/ModDelay.svg","traits":["1x","light"],"svgID":"Layer_1"}]},"https://www.amazon.com/Designing-Audio-Effect-Plug-Ins-Processing/dp/0240825152":{"title":"Designing Audio Effect Plug-Ins in C++","titleInlineContent":[{"type":"text","text":"Designing Audio Effect Plug-Ins in C++"}],"type":"link","identifier":"https:\/\/www.amazon.com\/Designing-Audio-Effect-Plug-Ins-Processing\/dp\/0240825152","url":"https:\/\/www.amazon.com\/Designing-Audio-Effect-Plug-Ins-Processing\/dp\/0240825152"}}}